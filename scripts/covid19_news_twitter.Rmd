---
title: "COVID19 Africa response"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_notebook:
    code_folding: hide
    html_preview: true
    toc: true
    toc_depth: 2
---

```{r setup, echo=FALSE, include=FALSE}
knitr::opts_knit$set(root.dir = normalizePath("~/Documents/freightwaves/proj-sworland-simple-rates")) 

library(rtweet)
library(tidyverse)
library(rvest)
theme_set(theme_bw(base_size=20))
```

Load csv of twitter handles,

```{r}
news_sites <- read_csv('data/africa_news_sites.csv', na = c("null",""," "))
head(news_sites)
```

To search the handles we need to strip the "@", look up user, and collect the data,

```{r, warning=FALSE, message='FALSE'}
news_tweets <- news_sites %>%
  mutate(screen_name = str_remove(twitter_handle,"@")) %>%
  drop_na(screen_name) %>%
  pull(screen_name) %>%
  lookup_users() %>%
  tweets_data() %>%
  filter(created_at >= '2019-12-01') %>%
  select(created_at,screen_name,text,favorite_count,
         retweet_count,hashtags,linked_url=urls_expanded_url) %>%
  unnest(linked_url)

```

Lookup data on the news handles to make sure we are looking at what we think we are,

```{r}
hold <- read_html(news_tweets$linked_url[3]) %>%
   html_nodes(xpath='//*[@id="root"]/div/main/div[3]/div/div[6]') %>%      
        html_text() 
```






